Search.setIndex({"docnames": ["fine-tuning", "introduction", "llama-cpp", "retrieval", "slurm_gpu_usage", "survey", "takeaways", "transformers", "use_case", "vision", "welcome"], "filenames": ["fine-tuning.ipynb", "introduction.ipynb", "llama-cpp.ipynb", "retrieval.ipynb", "slurm_gpu_usage.ipynb", "survey.ipynb", "takeaways.ipynb", "transformers.ipynb", "use_case.ipynb", "vision.ipynb", "welcome.ipynb"], "titles": ["Fine-tuning", "Introduction", "Using llama_cpp_python to run LLMs", "<font color='purple'><strong>Retrieval Augmented Generation</strong></font>", "SLURM Jobs and GPU Usage", "LLMs for Survey", "Summary and Takeaways", "<font color='purple'><strong>Using Transformers to run LLMs</strong></font>", "<font color='purple'><strong>Example Use Case</strong></font>", "<font color='purple'><strong>Process Images with bakllava</strong></font>", "Welcome"], "terms": {"thi": [1, 2, 3, 4, 9, 10], "websit": 10, "kellogg": [1, 2, 3, 4, 7, 9, 10], "research": [4, 10], "support": [3, 4, 10], "open": [1, 2, 3, 4, 9, 10], "sourc": [1, 2, 3, 7, 9, 10], "llm": [1, 3, 4, 9, 10], "cookbook": 10, "The": [1, 2, 3, 4, 7, 9, 10], "book": 10, "aim": 10, "give": 10, "you": [2, 3, 4, 9, 10], "skill": 10, "need": [7, 10], "work": 10, "effect": 10, "larg": [2, 3, 4, 7, 10], "languag": [2, 3, 10], "model": [1, 2, 3, 10], "1": [2, 3, 4, 7, 9], "load": [2, 3, 4, 7, 9], "paramet": [3, 4, 7], "2": [2, 3, 4, 7, 9], "convert": 7, "prompt": [2, 7, 9], "queri": [3, 7], "token": [7, 9], "3": [2, 3, 7, 9], "call": 7, "process": [3, 4, 7], "gener": [2, 4, 7, 9], "respons": [2, 3, 4, 7, 9], "4": [3, 7, 9], "decod": [7, 9], "text": [2, 3, 7], "test_llama2": [3, 7], "py": [2, 3, 4, 7, 9], "from": [1, 2, 3, 7, 9], "import": [2, 3, 4, 7, 9], "autotoken": 7, "automodelforcausallm": 7, "bitsandbytesconfig": 7, "time": [1, 3, 4, 7, 9], "panda": 7, "pd": 7, "pathlib": [3, 7], "path": [2, 3, 7], "start_tim": 3, "llm_dir": [7, 9], "data": [3, 7, 9], "llm_models_opensourc": [3, 7, 9], "llama2_meta_huggingfac": [3, 7], "llm_model": [7, 9], "meta": [2, 3, 7], "llama": [1, 2, 3, 7], "7b": [2, 3, 7], "chat": [3, 7], "hf": [1, 3, 7, 9], "13b": [3, 7], "70b": 7, "quantization_config": 7, "load_in_8bit": 7, "true": [3, 7, 9], "from_pretrain": [7, 9], "cache_dir": [7, 9], "device_map": [3, 7], "auto": [3, 7], "print": [2, 3, 4, 7, 9], "f": [3, 7], "second": 3, "For": [2, 4, 7], "llama2": [2, 3, 9], "enclos": 7, "your": [2, 3, 4, 7, 9], "inst": [3, 7], "tell": 7, "fun": 7, "fact": 7, "about": [3, 4, 7], "busi": 7, "school": 7, "devic": [4, 7], "cuda": 7, "model_input": 7, "return_tensor": [7, 9], "pt": [7, 9], "customize_set": 7, "max_new_token": [3, 7, 9], "400": [7, 9], "do_sampl": [3, 7, 9], "temperatur": [2, 3, 7], "0": [2, 3, 4, 7, 9], "8": [7, 9], "custom": [3, 7], "set": [2, 3, 4, 7, 9], "kei": 7, "valu": [4, 7], "item": 7, "output": [3, 7, 9], "skip_special_token": [7, 9], "end_tim": [], "execution_tim": [], "execut": [1, 3], "finished_tim": 7, "strftime": 7, "y": 7, "m": [3, 7], "d": [3, 7, 9], "h": 7, "s": [2, 3, 7, 9], "localtim": 7, "finish": 3, "log": [3, 7], "column": 7, "row": 7, "append": 7, "df": 7, "datafram": 7, "llm_name": 7, "split": [3, 7], "log_fil": 7, "log_": 7, "csv": [3, 7], "to_csv": 7, "index": [3, 7], "fals": [7, 9], "mode": 7, "header": 7, "exist": 7, "rag": 3, "power": [2, 3, 4], "paradigm": 3, "natur": 3, "combin": 3, "strength": 3, "approach": 3, "involv": 3, "relev": 3, "dataset": 3, "enhanc": 3, "accur": [3, 9], "It": [2, 3], "can": [2, 3, 4, 9], "anoth": 4, "method": 4, "fine": [1, 3, 9], "tune": [1, 3, 9], "phrase": 3, "come": [3, 4], "recent": 3, "paper": 3, "lewi": 3, "et": 3, "al": 3, "facebook": 3, "ai": [1, 3], "idea": 3, "pre": 3, "lm": 3, "separ": 3, "system": [3, 4], "find": 3, "document": 3, "condit": 3, "start": [3, 4], "reli": 3, "5": [3, 9], "step": 3, "differ": [2, 3, 4], "file": [2, 3, 4, 9], "url": 3, "pdf": 3, "divers": 3, "locat": [3, 4], "s3": 3, "storag": 3, "public": 3, "site": [3, 7], "etc": [1, 3, 7, 9], "transform": [3, 8], "also": [2, 9], "determin": 4, "part": [], "To": [2, 3, 4, 7], "prepar": 3, "larger": 3, "often": 4, "necessari": [], "chunk": [3, 4], "emb": 3, "next": [], "embed": [3, 9], "must": [], "creat": [3, 4], "captur": 3, "semant": 3, "mean": 3, "later": 3, "enabl": [2, 3], "mdoel": [], "effici": [3, 4], "other": 3, "piec": 3, "ar": [1, 2, 3, 4, 9], "similar": [2, 3], "store": 3, "vector": 3, "search": [3, 4], "retriv": [], "One": [3, 4], "organ": 3, "produc": 3, "more": [2, 4], "context": 3, "awar": 3, "dure": [3, 9], "runtim": 3, "blend": 3, "rich": 3, "content": [3, 9], "taken": 3, "http": [2, 3, 4, 7, 9], "doc": 3, "llamaindex": 3, "en": 3, "stabl": 3, "_static": 3, "getting_start": 3, "basic_rag": 3, "png": 3, "question": [3, 4], "answer": [3, 4], "vast": 3, "knowledg": 3, "base": [2, 3], "multipl": [3, 4], "creation": 3, "In": 4, "applic": 1, "creativ": 1, "pull": 3, "detail": [3, 9], "wide": 3, "rang": 3, "convers": 3, "agent": 3, "chatbot": [], "benefit": [], "incorpor": 3, "extern": [1, 3], "code": [2, 3, 9], "assist": [3, 9], "snippet": 3, "program": [3, 4], "todai": 3, "prevent": 3, "hallucin": 3, "bring": 3, "check": [3, 4, 7], "whether": [3, 4], "gpt": 3, "provid": [2, 3, 9], "wai": [3, 4], "feed": 3, "up": [3, 4, 7], "date": 3, "wa": 3, "between": [3, 9], "januari": 3, "2023": 3, "juli": 3, "mistral": [2, 3], "releas": 3, "septemb": 3, "let": 3, "ask": [3, 9], "run": [1, 3, 4], "throught": [], "what": 3, "i": 3, "familiar": 3, "possibl": [3, 9], "proprietari": 3, "develop": 3, "specif": [3, 4], "individu": [3, 4], "known": 3, "There": 3, "mani": [3, 4], "avail": [2, 3, 4, 9], "each": [2, 3, 4], "own": [3, 4, 7], "weak": 3, "choos": 3, "right": 3, "some": [2, 3, 4, 9], "popular": 3, "includ": 3, "bert": 3, "roberta": 3, "xlnet": 3, "These": 3, "have": [1, 3, 4, 9], "been": [3, 9], "task": [2, 3, 4], "sentiment": 3, "analysi": 3, "classif": 3, "If": [3, 4], "ani": [2, 3], "its": 3, "capabl": 3, "perform": [1, 3, 4], "mai": [3, 9], "abl": 3, "found": [2, 3], "here": [2, 3, 4, 9], "new": [3, 7, 9], "announc": 3, "resolv": 3, "we": [2, 3, 4, 9], "note": [2, 3, 4], "below": [3, 4], "take": [3, 4, 9], "webpag": 3, "follow": [2, 3, 7, 9], "outlin": 3, "abov": [3, 9], "librari": [2, 3], "os": [], "sy": 3, "llama_index": 3, "core": [3, 4, 9], "vectorstoreindex": 3, "simpledirectoryread": 3, "storagecontext": 3, "load_index_from_storag": 3, "chatprompttempl": [], "response_synthes": [], "treesummar": [], "openai": [], "openaiembed": [], "node_pars": 3, "sentencesplitt": 3, "huggingfac": [3, 7, 9], "huggingfacellm": 3, "chatmessag": [], "messagerol": [], "faiss": 3, "vector_stor": 3, "faissvectorstor": 3, "torch": [4, 9], "request": [3, 4, 9], "bs4": 3, "beautifulsoup": 3, "basicconfig": 3, "stream": [3, 9], "stdout": 3, "level": 3, "info": [3, 7], "getlogg": 3, "addhandl": 3, "streamhandl": 3, "download": [1, 2, 3], "web": 3, "url_link": 3, "get": [3, 4, 9], "soup": 3, "html": [3, 4], "parser": 3, "webpage_cont": 3, "get_text": 3, "strip": 3, "data_fold": 3, "test_data": 3, "mkdir": 3, "txt_file": 3, "txt": 3, "w": 3, "write": 3, "api": [], "api_fil": [], "env": [4, 7, 9], "r": [], "environ": 4, "openai_api_kei": [], "read": [], "embedding_model": [], "small": 4, "embed_model": 3, "embedding_chunk_s": 3, "512": [2, 3], "load_data": 3, "1536": [], "dimens": 3, "faiss_index": 3, "indexflatl2": 3, "storage_context": 3, "from_default": 3, "from_docu": 3, "chunk_siz": 3, "llama2_13b_chat": 3, "snapshot": 3, "29655417e51232f4f2b9b5d3e1418e5a9b04e80": 3, "selected_model": 3, "context_window": 3, "4096": 3, "256": 3, "tokenizer_nam": 3, "model_nam": 3, "query_engin": 3, "as_query_engin": 3, "select": [1, 3], "httpx": [], "post": [], "com": [2, 9], "v1": 9, "200": [], "ok": [], "7": 3, "3b": [], "size": 9, "outperform": 3, "all": [2, 4], "benchmark": [1, 3], "codellama": 3, "group": [], "attent": [], "gqa": [], "faster": 4, "infer": [], "slide": [], "window": [], "swa": [], "handl": 4, "longer": 4, "sequenc": 2, "smaller": 4, "cost": 7, "under": [1, 3], "apach": 3, "licens": [1, 3], "without": [3, 4], "restrict": [3, 4], "hug": 7, "face": 7, "co": [7, 9], "directori": [2, 4, 7, 9], "gpu": [2, 7, 9], "job": 7, "quest": [1, 4, 7], "chang": 7, "sbatch": [2, 4, 7, 9], "A": [2, 4, 7, 9], "p": [2, 7, 9], "line": [4, 7], "run_batch_llama2": 7, "sh": [4, 7, 9], "bin": [2, 4, 7, 9], "bash": [2, 4, 7, 9], "your_quest_allocation_account": [2, 7, 9], "gengpu": [2, 4, 7, 9], "gre": [2, 4, 7, 9], "a100": [2, 4, 7, 9], "n": [2, 7, 9], "t": [2, 4, 7, 9], "30": [2, 4, 7, 9], "00": [2, 3, 4, 7, 9], "mem": [2, 4, 7, 9], "40g": [2, 4, 7, 9], "modul": [2, 4, 7, 9], "purg": [2, 4, 7, 9], "mamba": [7, 9], "23": [7, 9], "hpc": [7, 9], "softwar": [2, 4, 7, 9], "profil": [7, 9], "conda": [7, 9], "activ": [4, 7, 9], "out": [4, 7], "test_mistr": 7, "tset_gemma": [], "python": [2, 9], "wrapper": 2, "c": 2, "implement": 2, "architectur": [2, 4], "access": 2, "built": 2, "cpp": [1, 2], "framework": 2, "like": [2, 4, 9], "translat": 2, "inform": 2, "see": 2, "repo": [2, 3], "ggerganov": 2, "abetlen": 2, "overview": 2, "www": [2, 4], "datacamp": 2, "tutori": 2, "_": 2, "compat": 2, "weight": [2, 7], "proviv": 2, "sampl": [2, 9], "gemma": 2, "instruct": [2, 3], "llama_cpp": [2, 9], "input": [2, 9], "model_path": 2, "gguf": [2, 9], "context_s": 2, "float": 2, "basic": 2, "summari": 2, "gui": 2, "debord": 2, "societ": 2, "du": 2, "spectacl": 2, "written": 2, "syntax": 2, "start_of_turn": 2, "user": [2, 9], "end_of_turn": 2, "THE": 2, "n_ctx": [2, 9], "max": 2, "length": 2, "adjust": [2, 4], "requir": [2, 4], "n_thread": [2, 9], "number": [2, 4, 9], "cpu": [2, 9], "thread": 2, "n_gpu_lay": [2, 9], "want": 2, "onli": [2, 4], "send": [2, 4], "concis": 2, "max_token": 2, "1000": [2, 4], "response_text": 2, "choic": [2, 9], "save": [2, 4, 9], "klc": [1, 2, 4], "bound": 2, "our": [2, 3, 4, 9], "modulefil": [2, 9], "38": [2, 9], "python3": [2, 9], "llama_cpp_test": [], "consist": [], "billion": 3, "order": 4, "speed": 4, "node": [], "alloc": 4, "northwestern": 4, "edu": 4, "depart": 4, "servic": 4, "comput": 7, "type": [4, 7, 9], "ll": 4, "submit": 4, "through": [3, 4], "schedul": 4, "allow": 4, "test": [2, 4], "tensor": 4, "admin": 4, "gpu_test_fil": 4, "pytorch_gpu_test": 4, "is_avail": 4, "device_count": 4, "get_device_nam": 4, "els": 4, "accordingli": 4, "being": 4, "us": [1, 4, 9], "two": 4, "random": 4, "tensor1": 4, "randn": 4, "tensor2": 4, "add": 4, "oper": 4, "result": 4, "so": 4, "long": [], "launch": [2, 4], "pytorch": 4, "break": 4, "down": 4, "srun": [], "an": 4, "interact": [], "partit": 4, "direct": 4, "genom": 4, "cluster": [1, 4], "account": 4, "xxxxx": [], "refer": [], "given": 4, "specifi": 4, "sinc": [], "cannot": [], "ntask": 4, "per": 4, "how": [4, 9], "paralleliz": 4, "otherwis": 4, "slow": 4, "stand": 4, "resourc": [1, 4], "By": 4, "exclud": 4, "indic": 4, "minut": 4, "much": 4, "memori": [4, 7], "after": 4, "final": 4, "receiv": 4, "id": 4, "batch": [3, 4], "9428806": 4, "onc": 4, "complet": 4, "job_id": 4, "current": 4, "llm_core": 9, "llavacppmodel": 9, "q4_k_m": 9, "name": [7, 9], "llama_cpp_kwarg": 9, "logits_al": 9, "8000": 9, "verbos": 9, "don": 9, "clip_model_path": 9, "clip": 9, "load_model": 9, "histori": 9, "role": 9, "image_url": 9, "advanc": 9, "stack": 9, "asset": 9, "img": 9, "mappemond": 9, "jpg": 9, "describ": 9, "messag": 9, "pleas": [4, 9], "home": 9, "slurm": 9, "script": 9, "image_test": 9, "info_": [], "test_gemma": 7, "project": [1, 7], "space": 7, "option": 7, "veri": 7, "reduc": 7, "repres": [7, 9], "lower": 7, "precis": 7, "form": 8, "demonstr": [3, 8], "reproduc": 8, "principl": 8, "huggingfaceembed": 3, "embedding_nam": 3, "baai": [], "bge": [], "intfloat": 3, "multilingu": 3, "e5": 3, "max_length": 3, "generate_kwarg": 3, "top_p": 3, "9": 3, "top_k": 3, "1024": 3, "100": [3, 9], "66": 3, "66it": 3, "variou": 3, "while": [3, 4], "remain": 3, "good": 3, "english": 3, "easi": 3, "ha": 3, "gemma_test": 2, "likewis": 2, "mistral_test": 2, "llama2_test": 2, "respect": 2, "subfold": 2, "workshop": [1, 4], "leverag": 4, "do": 4, "temporari": 4, "pxxxxxx": [], "afterward": 4, "purpos": 4, "primarili": [], "calcul": 4, "hear": 4, "talk": 4, "section": 4, "term": 4, "equip": 4, "both": [4, 9], "processor": [4, 9], "graphic": 4, "card": [1, 4], "central": 4, "unit": 4, "mathemat": 4, "logic": 4, "nutshel": 4, "extrem": 4, "most": 4, "infinitesim": 4, "short": 4, "amount": 4, "one": 4, "thing": 4, "sequenti": 4, "solv": 4, "singl": 4, "problem": 4, "simultan": 4, "essenti": 4, "distribut": 4, "over": 4, "special": [4, 9], "hardwar": 4, "compon": 4, "comparison": 4, "24": 4, "entitl": [], "contain": 4, "6": 4, "912": 4, "whiel": [], "less": 4, "than": 4, "sheer": 4, "volum": 4, "them": 4, "make": [4, 9], "ideal": 4, "better": [4, 9], "why": 4, "aren": 4, "quickli": 4, "actual": 4, "instanc": 4, "sort": 4, "list": 4, "divid": 4, "among": 4, "portion": 4, "commun": 4, "coordin": 4, "rel": 4, "across": 4, "might": 4, "compelt": [], "alon": 4, "potenti": 4, "ineffici": 4, "rais": 4, "know": 4, "when": 4, "where": 4, "unifi": 4, "platform": 4, "help": [4, 9], "intensitv": [], "switch": [], "certain": 4, "folder": 3, "github": 3, "goal": 1, "look": 1, "best": 1, "practic": 1, "regard": 1, "linux": 1, "adapt": 1, "improv": 1, "integr": 1, "lifecycl": 1, "diagram": 1, "imag": [1, 4], "deeplearn": 1, "common": 1, "defin": 1, "case": 1, "hub": 1, "leaderboard": 1, "e32337": 4, "On": 4, "intens": 4, "optim": 4, "which": [4, 9], "deleg": 4, "gpu_pytorch_test": 4, "simpli": 4, "explain": 4, "pil": 9, "autoprocessor": 9, "llavaforconditionalgener": 9, "llava": 9, "nyou": 9, "mom": 9, "ag": 9, "25": 9, "market": 9, "survei": 9, "diaper": 9, "packag": 9, "appeal": 9, "nassist": 9, "image_fil": 9, "i5": 9, "walmartimag": 9, "seo": 9, "babi": 9, "newborn": 9, "10": 9, "lb": 9, "120": 9, "count": 9, "pamper": 9, "swaddler": 9, "onemonth": 9, "suppli": 9, "vary_95ea2d1c": 9, "769a": 9, "4ec2": 9, "8da8": 9, "7e6ea4829e55": 9, "3c890f8095b5b30ae263c996151f9575": 9, "jpeg": 9, "torch_dtyp": 9, "float16": 9, "low_cpu_mem_usag": 9, "raw_imag": 9, "raw": 9, "checkpoint": 9, "shard": 9, "01": 9, "61it": 9, "75": 9, "81it": 9, "02it": 9, "ad": 9, "vocabulari": 9, "sure": 9, "associ": 9, "word": 9, "train": 9, "er": 9, "me": 9, "featur": 9, "heartwarm": 9, "parent": 9, "hold": 9, "evok": 9, "feel": 9, "love": 9, "care": 9, "joi": 9, "parenthood": 9, "shown": 9, "rest": 9, "comfort": 9, "pad": 9, "sens": 9, "secur": 9, "warmth": 9, "infant": 9, "sooth": 9, "colicki": 9, "ensur": 9, "sleep": 9, "connect": 9, "tender": 9, "moment": 9, "experi": 9, "brand": 9, "understand": 9, "bond": 9, "live": 9, "runn": 9, "test_bakllava": 9}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"introduct": 1, "welcom": 10, "fine": 0, "tune": 0, "how": 3, "us": [2, 3, 7, 8], "llama": [], "cpp": [], "run": [2, 7, 9], "llm": [2, 5, 7], "retriev": 3, "augment": 3, "gener": 3, "slurm": [2, 4, 7], "job": 4, "manag": [], "gpu": 4, "usag": 4, "survei": 5, "summari": 6, "takeawai": 6, "transform": [7, 9], "vision": [], "imag": 9, "text": [], "basic": 7, "workflow": 7, "work": 3, "sampl": [3, 4], "case": [3, 8], "exampl": [3, 8], "inform": 3, "non": 3, "exist": 3, "train": 3, "llama2": 7, "model": [7, 9], "python": [4, 7], "script": [2, 3, 4, 7], "mistral": 7, "gemma": 7, "font": [2, 3, 4, 7, 8, 9], "color": [2, 3, 4, 7, 8, 9], "purpl": [2, 3, 4, 7, 8, 9], "llama_cpp_python": [2, 9], "1": [], "code": 4, "2": [], "process": [8, 9], "bakllava": 9, "10k": 8, "understand": 4, "parallel": 4, "comput": 4, "more": 3, "object": 1, "cpu": 4, "limit": 4, "cuda": 4, "access": 4, "node": 4, "refer": 4, "sourc": 4}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})