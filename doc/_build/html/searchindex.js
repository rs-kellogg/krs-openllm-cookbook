Search.setIndex({"docnames": ["fine-tuning", "introduction", "llama-cpp", "retrieval", "slurm_gpu_usage", "survey", "takeaways", "transformers", "vision", "welcome"], "filenames": ["fine-tuning.ipynb", "introduction.ipynb", "llama-cpp.ipynb", "retrieval.ipynb", "slurm_gpu_usage.ipynb", "survey.ipynb", "takeaways.ipynb", "transformers.ipynb", "vision.ipynb", "welcome.ipynb"], "titles": ["Fine-tuning", "Introduction", "<font color='purple'><strong>Using llama_cpp_Python to run LLMs</strong></font>", "Retrieval Augmented Generation", "<font color='purple'>SLURM Jobs and GPU Usage</font>", "LLMs for Survey", "Summary and Takeaways", "How to Use Transformers to run LLMs", "<font color='purple'><strong>Process Images with bakllava</strong></font>", "Welcome"], "terms": {"thi": [2, 3, 4, 8, 9], "websit": 9, "kellogg": [2, 3, 4, 7, 9], "research": [4, 9], "support": [3, 4, 9], "open": [2, 3, 4, 9], "sourc": [2, 3, 4, 7, 9], "llm": [3, 4, 8, 9], "cookbook": 9, "The": [2, 3, 4, 7, 9], "book": 9, "aim": 9, "give": 9, "you": [2, 3, 4, 8, 9], "skill": 9, "need": [4, 7, 9], "work": 9, "effect": 9, "larg": [2, 3, 9], "languag": [2, 3, 9], "model": [2, 3, 4, 8, 9], "1": [2, 3, 7, 8], "load": [2, 3, 4, 7, 8], "paramet": [3, 4, 7], "2": [2, 3, 7, 8], "convert": 7, "prompt": [2, 7], "queri": [3, 7], "token": 7, "3": [2, 3, 7], "call": 7, "process": [3, 4, 7], "gener": [2, 4, 7], "respons": [2, 3, 7, 8], "4": [3, 7], "decod": 7, "text": [2, 3, 7], "test_llama2": [3, 7], "py": [2, 3, 4, 7, 8], "from": [2, 3, 7, 8], "import": [2, 3, 4, 7, 8], "autotoken": 7, "automodelforcausallm": 7, "bitsandbytesconfig": 7, "time": [4, 7], "panda": 7, "pd": 7, "pathlib": [3, 7], "path": [2, 3, 7], "start_tim": 7, "llm_dir": 7, "data": [3, 7], "llm_models_opensourc": [3, 7], "llama2_meta_huggingfac": [3, 7], "llm_model": 7, "meta": [2, 3, 7], "llama": [2, 3, 7], "7b": [2, 3, 7], "chat": [3, 7], "hf": [3, 7], "13b": [3, 7], "70b": 7, "quantization_config": 7, "load_in_8bit": 7, "true": [7, 8], "from_pretrain": 7, "cache_dir": 7, "device_map": [3, 7], "auto": [3, 7], "print": [2, 3, 4, 7, 8], "f": [3, 7], "second": 7, "For": [2, 7], "llama2": [2, 3], "enclos": 7, "your": [2, 3, 4, 7, 8], "inst": [3, 7], "tell": 7, "fun": 7, "fact": 7, "about": [3, 7], "busi": 7, "school": 7, "devic": [4, 7], "cuda": [4, 7], "model_input": 7, "return_tensor": 7, "pt": 7, "customize_set": 7, "max_new_token": [3, 7], "400": 7, "do_sampl": 7, "temperatur": [2, 7], "0": [2, 3, 4, 7, 8], "8": [7, 8], "custom": [3, 7], "set": [2, 3, 4, 7, 8], "kei": [3, 7], "valu": 7, "item": 7, "output": [3, 7], "skip_special_token": 7, "end_tim": 7, "execution_tim": 7, "execut": 7, "finished_tim": 7, "strftime": 7, "y": 7, "m": [3, 7], "d": [3, 7], "h": 7, "s": [2, 3, 7], "localtim": 7, "finish": [3, 7], "log": [3, 7], "column": 7, "row": 7, "append": 7, "df": 7, "datafram": 7, "llm_name": 7, "split": [3, 7], "log_fil": 7, "log_": 7, "csv": [3, 7], "to_csv": 7, "index": [3, 7], "fals": [7, 8], "mode": 7, "header": 7, "exist": 7, "rag": 3, "power": [2, 3], "paradigm": 3, "natur": 3, "combin": 3, "strength": 3, "approach": 3, "involv": 3, "relev": 3, "dataset": 3, "enhanc": 3, "accur": [3, 8], "It": [2, 3], "can": [2, 3, 4, 8], "anoth": 3, "method": 3, "fine": 3, "tune": 3, "phrase": 3, "come": 3, "recent": 3, "paper": 3, "lewi": 3, "et": 3, "al": 3, "facebook": 3, "ai": 3, "idea": 3, "pre": 3, "lm": 3, "separ": 3, "system": 3, "find": 3, "document": 3, "condit": 3, "start": [3, 4], "reli": 3, "5": 3, "step": 3, "differ": [2, 3], "file": [2, 3, 4, 8], "url": 3, "pdf": 3, "divers": 3, "locat": [3, 4], "s3": 3, "storag": 3, "public": 3, "site": [3, 7], "etc": [3, 7], "transform": 3, "also": 3, "determin": 3, "part": 3, "To": [2, 3, 4, 7], "prepar": 3, "larger": 3, "often": 3, "necessari": 3, "chunk": 3, "emb": 3, "next": 3, "embed": 3, "must": [3, 4], "creat": [3, 4], "captur": 3, "semant": 3, "mean": 3, "later": 3, "enabl": [2, 3], "mdoel": 3, "effici": 3, "other": 3, "piec": 3, "ar": [3, 4], "similar": 3, "store": 3, "vector": 3, "search": 3, "retriv": 3, "One": 3, "organ": 3, "produc": 3, "more": [2, 3], "context": 3, "awar": 3, "dure": 3, "runtim": 3, "blend": 3, "rich": 3, "content": [3, 8], "taken": 3, "http": [2, 3, 4, 7, 8], "doc": 3, "llamaindex": 3, "en": 3, "stabl": 3, "_static": 3, "getting_start": 3, "basic_rag": 3, "png": 3, "question": 3, "answer": 3, "vast": 3, "knowledg": 3, "base": [2, 3], "multipl": 3, "creation": 3, "In": [3, 4], "applic": 3, "creativ": 3, "pull": 3, "detail": 3, "wide": 3, "rang": 3, "convers": 3, "agent": 3, "chatbot": 3, "benefit": 3, "incorpor": 3, "extern": 3, "code": [2, 3, 8], "assist": 3, "snippet": 3, "program": 3, "todai": [3, 4], "prevent": 3, "hallucin": 3, "bring": 3, "check": [3, 4, 7], "whether": [3, 4], "gpt": 3, "provid": [2, 3], "wai": 3, "feed": 3, "up": [3, 4, 7], "date": 3, "wa": 3, "between": 3, "januari": 3, "2023": 3, "juli": 3, "mistral": [2, 3], "releas": 3, "septemb": 3, "let": 3, "ask": [3, 8], "run": [3, 4, 8], "throught": 3, "what": 3, "i": 3, "familiar": 3, "possibl": [3, 8], "proprietari": 3, "develop": 3, "specif": 3, "individu": 3, "known": 3, "There": 3, "mani": [3, 4], "avail": [2, 3, 4, 8], "each": 3, "own": 3, "weak": 3, "choos": 3, "right": 3, "some": [2, 3, 4, 8], "popular": 3, "includ": 3, "bert": 3, "roberta": 3, "xlnet": 3, "These": 3, "have": [3, 4, 8], "been": 3, "task": [2, 3], "sentiment": 3, "analysi": 3, "classif": 3, "If": 3, "ani": [2, 3], "its": 3, "capabl": 3, "perform": [3, 4], "mai": 3, "abl": 3, "found": 3, "here": [2, 3, 4, 8], "new": 3, "announc": 3, "resolv": 3, "we": [2, 3, 4], "note": [2, 3], "below": [3, 4], "take": 3, "webpag": 3, "follow": [2, 3, 7, 8], "outlin": 3, "abov": 3, "librari": [2, 3], "os": 3, "sy": 3, "llama_index": 3, "core": [3, 4, 8], "vectorstoreindex": 3, "simpledirectoryread": 3, "storagecontext": 3, "load_index_from_storag": 3, "chatprompttempl": 3, "response_synthes": 3, "treesummar": 3, "openai": 3, "openaiembed": 3, "node_pars": 3, "sentencesplitt": 3, "huggingfac": [3, 7], "huggingfacellm": 3, "chatmessag": 3, "messagerol": 3, "faiss": 3, "vector_stor": 3, "faissvectorstor": 3, "torch": [3, 4], "request": [3, 4], "bs4": 3, "beautifulsoup": 3, "basicconfig": 3, "stream": 3, "stdout": 3, "level": 3, "info": [3, 7], "getlogg": 3, "addhandl": 3, "streamhandl": 3, "download": [2, 3], "web": 3, "url_link": 3, "get": [3, 4], "soup": 3, "html": [3, 4], "parser": 3, "webpage_cont": 3, "get_text": 3, "strip": 3, "data_fold": 3, "test_data": 3, "mkdir": 3, "txt_file": 3, "txt": 3, "w": 3, "write": 3, "api": 3, "api_fil": 3, "env": [3, 4, 7], "r": 3, "environ": [3, 4], "openai_api_kei": 3, "read": 3, "embedding_model": 3, "small": 3, "embed_model": 3, "embedding_chunk_s": 3, "512": [2, 3], "load_data": 3, "1536": 3, "dimens": 3, "faiss_index": 3, "indexflatl2": 3, "storage_context": 3, "from_default": 3, "from_docu": 3, "chunk_siz": 3, "llama2_13b_chat": 3, "snapshot": 3, "29655417e51232f4f2b9b5d3e1418e5a9b04e80": 3, "selected_model": 3, "context_window": 3, "4096": 3, "256": 3, "tokenizer_nam": 3, "model_nam": 3, "query_engin": 3, "as_query_engin": 3, "select": 3, "httpx": 3, "post": 3, "com": [2, 3, 8], "v1": 3, "200": 3, "ok": 3, "7": 3, "3b": 3, "size": 3, "outperform": 3, "all": [2, 3], "benchmark": 3, "codellama": 3, "group": 3, "attent": 3, "gqa": 3, "faster": 3, "infer": 3, "slide": 3, "window": 3, "swa": 3, "handl": 3, "longer": 3, "sequenc": [2, 3], "smaller": 3, "cost": 3, "under": 3, "apach": 3, "licens": 3, "without": 3, "restrict": [3, 4], "hug": 7, "face": 7, "co": 7, "directori": [2, 4, 7, 8], "gpu": [2, 7, 8], "job": 7, "quest": [4, 7], "chang": 7, "sbatch": [2, 4, 7, 8], "A": [2, 4, 7, 8], "p": [2, 4, 7, 8], "line": [4, 7], "run_batch_llama2": 7, "sh": 7, "bin": [2, 4, 7, 8], "bash": [2, 4, 7, 8], "your_quest_allocation_account": [2, 4, 7, 8], "gengpu": [2, 4, 7, 8], "gre": [2, 4, 7, 8], "a100": [2, 4, 7, 8], "n": [2, 4, 7, 8], "t": [2, 4, 7, 8], "30": [2, 4, 7, 8], "00": [2, 4, 7, 8], "mem": [2, 4, 7, 8], "40g": [2, 4, 7, 8], "modul": [2, 4, 7, 8], "purg": [2, 4, 7, 8], "mamba": 7, "23": 7, "hpc": 7, "softwar": [2, 4, 7], "profil": 7, "conda": 7, "activ": [4, 7], "out": [4, 7], "test_mistr": 7, "tset_gemma": 7, "python": 2, "wrapper": 2, "c": 2, "implement": 2, "architectur": 2, "access": [2, 4], "built": 2, "cpp": 2, "framework": 2, "like": [2, 4], "translat": 2, "inform": 2, "see": 2, "repo": 2, "ggerganov": 2, "abetlen": 2, "overview": 2, "www": [2, 4], "datacamp": 2, "tutori": 2, "_": 2, "compat": 2, "weight": [2, 4], "proviv": 2, "sampl": [2, 8], "gemma": 2, "instruct": 2, "llama_cpp": [2, 8], "input": 2, "model_path": 2, "gguf": [2, 8], "context_s": 2, "float": 2, "basic": 2, "summari": 2, "gui": 2, "debord": 2, "societ": 2, "du": 2, "spectacl": 2, "written": 2, "syntax": 2, "start_of_turn": 2, "user": [2, 8], "end_of_turn": 2, "THE": 2, "n_ctx": [2, 8], "max": 2, "length": 2, "adjust": [2, 4], "requir": [2, 4], "n_thread": [2, 8], "number": [2, 4, 8], "cpu": [2, 4, 8], "thread": 2, "n_gpu_lay": [2, 8], "want": 2, "onli": [2, 4], "send": 2, "concis": 2, "max_token": 2, "1000": [2, 4], "response_text": 2, "choic": [2, 8], "save": [2, 4, 8], "klc": 2, "bound": 2, "our": 2, "modulefil": [2, 8], "38": [2, 8], "python3": [2, 8], "llama_cpp_test": 2, "consist": 4, "billion": 4, "order": 4, "speed": 4, "node": 4, "alloc": 4, "northwestern": 4, "edu": 4, "depart": 4, "servic": 4, "comput": 4, "type": [4, 8], "ll": 4, "submit": 4, "through": 4, "schedul": 4, "allow": 4, "test": 4, "tensor": 4, "admin": 4, "gpu_test_fil": 4, "pytorch_gpu_test": 4, "is_avail": 4, "device_count": 4, "get_device_nam": 4, "els": 4, "accordingli": 4, "being": 4, "us": [4, 8], "two": 4, "random": 4, "tensor1": 4, "randn": 4, "tensor2": 4, "add": 4, "oper": 4, "result": 4, "so": 4, "long": 4, "launch": 4, "pytorch": 4, "break": 4, "down": 4, "srun": 4, "an": 4, "interact": 4, "partit": 4, "direct": 4, "genom": 4, "cluster": 4, "account": 4, "xxxxx": 4, "refer": 4, "given": 4, "specifi": 4, "sinc": 4, "cannot": 4, "ntask": 4, "per": 4, "how": 4, "paralleliz": 4, "otherwis": 4, "slow": 4, "stand": 4, "resourc": 4, "By": 4, "exclud": 4, "indic": 4, "minut": 4, "much": 4, "memori": 4, "after": 4, "final": 4, "receiv": 4, "id": 4, "batch": 4, "9428806": 4, "onc": 4, "complet": 4, "job_id": 4, "current": 4, "llm_core": 8, "llavacppmodel": 8, "q4_k_m": 8, "name": 8, "llama_cpp_kwarg": 8, "logits_al": 8, "8000": 8, "verbos": 8, "don": 8, "clip_model_path": 8, "clip": 8, "load_model": 8, "histori": 8, "role": 8, "image_url": 8, "advanc": 8, "stack": 8, "asset": 8, "img": 8, "mappemond": 8, "jpg": 8, "describ": 8, "messag": 8, "pleas": 8, "home": 8, "slurm": 8, "script": 8, "image_test": 8}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"introduct": 1, "welcom": 9, "fine": 0, "tune": 0, "how": [3, 7], "us": [2, 3, 7], "llama": [], "cpp": [], "run": [2, 7], "llm": [2, 5, 7], "retriev": 3, "augment": 3, "gener": 3, "slurm": [2, 4, 7], "job": 4, "manag": [], "gpu": 4, "usag": 4, "survei": 5, "summari": 6, "takeawai": 6, "transform": 7, "vision": [], "imag": 8, "text": [], "basic": 7, "workflow": 7, "work": 3, "sampl": [3, 4], "case": 3, "exampl": 3, "inform": 3, "non": 3, "exist": 3, "train": 3, "llama2": 7, "model": 7, "python": [4, 7], "script": [2, 4, 7], "mistral": 7, "gemma": 7, "font": [2, 4, 8], "color": [2, 4, 8], "purpl": [2, 4, 8], "llama_cpp_python": 2, "1": 4, "code": 4, "2": 4, "process": 8, "bakllava": 8}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})